{"ast":null,"code":"\"use client\";\n\nvar _jsxFileName = \"C:\\\\laragon\\\\www\\\\E-RAPORT-NUURUSH-SHOLAAH\\\\e-raport-client\\\\src\\\\dashboard\\\\input-nilai\\\\page.tsx\",\n  _s = $RefreshSig$();\nimport { useState, useEffect, useCallback, useRef } from \"react\";\nimport { Button } from \"../../components/ui/button\";\nimport DashboardLayout from '../../dashboard/layout';\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"../../components/ui/dialog\";\nimport { Input } from \"../../components/ui/input\";\nimport { Label } from \"../../components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"../../components/ui/select\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"../../components/ui/table\";\nimport { useToast } from \"../../components/ui/toast\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"../../components/ui/card\";\nimport { useForm, Controller } from 'react-hook-form';\nimport nilaiService from '../../services/nilaiService';\nimport siswaService from '../../services/siswaService';\nimport mapelService from '../../services/mapelService';\nimport kelasService from '../../services/kelasService';\nimport tahunAjaranService from '../../services/tahunAjaranService';\nimport excelService from '../../services/excelService';\nimport * as tingkatanService from '../../services/tingkatanService';\n\n// --- TIPE DATA ---\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function InputNilaiPage() {\n  _s();\n  const [nilaiList, setNilaiList] = useState([]);\n  const [options, setOptions] = useState({\n    siswa: [],\n    mapel: [],\n    kelas: [],\n    tahunAjaran: [],\n    tingkatan: []\n  });\n  const [filters, setFilters] = useState({\n    kelas_id: \"\",\n    tahun_ajaran_id: \"\",\n    tingkatan_id: \"\"\n  });\n  const [loading, setLoading] = useState(true);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [editingNilai, setEditingNilai] = useState(null);\n  const fileInputRef = useRef(null);\n  const [uploading, setUploading] = useState(false);\n  const {\n    toast\n  } = useToast();\n  const {\n    control,\n    handleSubmit,\n    reset,\n    setValue,\n    register\n  } = useForm({\n    defaultValues: {\n      siswa_id: \"\",\n      mapel_id: \"\",\n      nilai: \"\",\n      semester: \"\",\n      tahun_ajaran_id: \"\"\n    }\n  });\n  const fetchNilaiData = useCallback(async () => {\n    setLoading(true);\n    try {\n      const activeFilters = Object.fromEntries(Object.entries(filters).filter(([_, value]) => value !== \"\"));\n      const nilaiData = await nilaiService.getAllNilai(activeFilters);\n      setNilaiList(nilaiData);\n    } catch (error) {\n      console.error(\"Gagal memuat data nilai:\", error);\n      toast({\n        title: \"Gagal Memuat Nilai\",\n        description: \"Tidak dapat mengambil data nilai dari server.\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setLoading(false);\n    }\n  }, [filters, toast]);\n\n  // FIXED: Load options once on mount\n  useEffect(() => {\n    let mounted = true;\n    const loadOptions = async () => {\n      try {\n        const [siswaData, mapelData, tahunData, tingkatanData] = await Promise.all([siswaService.getAllSiswa({\n          show_all: true\n        }), mapelService.getAllMapel(), tahunAjaranService.getAllTahunAjaran(), tingkatanService.getAllTingkatans()]);\n        if (mounted) {\n          setOptions(prev => ({\n            ...prev,\n            siswa: siswaData,\n            mapel: mapelData,\n            tahunAjaran: tahunData,\n            tingkatan: tingkatanData\n          }));\n        }\n      } catch (error) {\n        console.error(\"Gagal memuat opsi dropdown:\", error);\n      }\n    };\n    loadOptions();\n    return () => {\n      mounted = false;\n    };\n  }, []);\n\n  // FIXED: Debounced fetch when filters change\n  useEffect(() => {\n    let timeoutId;\n    timeoutId = setTimeout(() => {\n      fetchNilaiData();\n    }, 300);\n    return () => clearTimeout(timeoutId);\n  }, [filters]);\n\n  // FIXED: Stable kelas fetching\n  useEffect(() => {\n    let mounted = true;\n    if (filters.tingkatan_id) {\n      kelasService.getKelasByTingkatan(filters.tingkatan_id).then(kelasData => {\n        if (mounted) {\n          setOptions(prev => ({\n            ...prev,\n            kelas: kelasData\n          }));\n        }\n      }).catch(err => console.error('Error fetching kelas:', err));\n    } else {\n      if (mounted) {\n        setOptions(prev => ({\n          ...prev,\n          kelas: []\n        }));\n        setFilters(f => ({\n          ...f,\n          kelas_id: \"\"\n        }));\n      }\n    }\n    return () => {\n      mounted = false;\n    };\n  }, [filters.tingkatan_id]);\n  const handleOpenDialog = nilai => {\n    setEditingNilai(nilai);\n    if (nilai) {\n      const ta = options.tahunAjaran.find(t => t.id === nilai.tahun_ajaran_id);\n      reset({\n        id: nilai.id,\n        siswa_id: String(nilai.siswa_id || \"\"),\n        mapel_id: String(nilai.mapel_id || \"\"),\n        nilai: String(nilai.nilai || \"\"),\n        semester: nilai.semester || (ta === null || ta === void 0 ? void 0 : ta.semester) || \"\",\n        tahun_ajaran_id: String(nilai.tahun_ajaran_id || \"\")\n      });\n    } else {\n      reset({\n        siswa_id: '',\n        mapel_id: '',\n        nilai: '',\n        semester: '',\n        tahun_ajaran_id: ''\n      });\n    }\n    setIsModalOpen(true);\n  };\n  const onSubmit = async formData => {\n    try {\n      const payload = {\n        ...formData,\n        siswa_id: Number(formData.siswa_id),\n        mapel_id: Number(formData.mapel_id),\n        tahun_ajaran_id: Number(formData.tahun_ajaran_id),\n        nilai: Number(formData.nilai)\n      };\n      if (editingNilai !== null && editingNilai !== void 0 && editingNilai.id) {\n        await nilaiService.updateNilai(editingNilai.id, payload);\n        toast({\n          title: \"Berhasil\",\n          description: \"Data nilai diperbarui\"\n        });\n      } else {\n        await nilaiService.createNilai(payload);\n        toast({\n          title: \"Berhasil\",\n          description: \"Data nilai ditambahkan\"\n        });\n      }\n      setIsModalOpen(false);\n      fetchNilaiData();\n    } catch (error) {\n      var _error$response, _error$response$data;\n      toast({\n        title: \"Gagal\",\n        description: ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || \"Gagal menyimpan data.\",\n        variant: \"destructive\"\n      });\n    }\n  };\n  const handleDelete = async id => {\n    if (window.confirm(\"Apakah Anda yakin ingin menghapus data nilai ini?\")) {\n      try {\n        await nilaiService.deleteNilai(id);\n        toast({\n          title: \"Berhasil\",\n          description: \"Data nilai dihapus\"\n        });\n        fetchNilaiData();\n      } catch (error) {\n        var _error$response2, _error$response2$data;\n        toast({\n          title: \"Gagal\",\n          description: ((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message) || \"Gagal menghapus data.\",\n          variant: \"destructive\"\n        });\n      }\n    }\n  };\n  const handleDownloadTemplate = async () => {\n    if (!filters.tahun_ajaran_id || !filters.tingkatan_id || !filters.kelas_id) {\n      toast({\n        title: \"Filter Tidak Lengkap\",\n        description: \"Harap pilih Tahun Ajaran, Tingkatan, dan Kelas terlebih dahulu.\",\n        variant: \"destructive\"\n      });\n      return;\n    }\n    try {\n      const blobData = await excelService.downloadCompleteTemplate({\n        kelas_id: filters.kelas_id,\n        tahun_ajaran_id: filters.tahun_ajaran_id,\n        tingkatan_id: filters.tingkatan_id\n      });\n      const blob = new Blob([blobData], {\n        type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\n      });\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement(\"a\");\n      a.href = url;\n      a.download = `template-nilai-lengkap.xlsx`;\n      a.click();\n      window.URL.revokeObjectURL(url);\n      toast({\n        title: \"Template berhasil diunduh\"\n      });\n    } catch (e) {\n      var _e$response, _e$response$data;\n      toast({\n        title: \"Gagal Unduh\",\n        description: (e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.message) || \"Terjadi kesalahan saat membuat template.\",\n        variant: \"destructive\"\n      });\n    }\n  };\n  const handleUploadExcel = async () => {\n    var _fileInputRef$current, _fileInputRef$current2;\n    const file = (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : (_fileInputRef$current2 = _fileInputRef$current.files) === null || _fileInputRef$current2 === void 0 ? void 0 : _fileInputRef$current2[0];\n    if (!file) {\n      toast({\n        title: \"Pilih File\",\n        description: \"Silakan pilih file Excel untuk diunggah.\",\n        variant: \"destructive\"\n      });\n      return;\n    }\n    setUploading(true);\n    const fd = new FormData();\n    fd.append(\"file\", file);\n    try {\n      const json = await excelService.uploadCompleteData(fd);\n      toast({\n        title: \"Upload Selesai\",\n        description: (json === null || json === void 0 ? void 0 : json.message) || \"File berhasil diproses.\"\n      });\n      fetchNilaiData();\n    } catch (e) {\n      var _e$response2, _e$response2$data;\n      toast({\n        title: \"Gagal Upload\",\n        description: (e === null || e === void 0 ? void 0 : (_e$response2 = e.response) === null || _e$response2 === void 0 ? void 0 : (_e$response2$data = _e$response2.data) === null || _e$response2$data === void 0 ? void 0 : _e$response2$data.message) || \"Terjadi kesalahan saat mengunggah file.\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setUploading(false);\n      if (fileInputRef.current) fileInputRef.current.value = \"\";\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(DashboardLayout, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-3xl font-bold\",\n        children: \"Manajemen Input Nilai\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Card, {\n        children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-col md:flex-row justify-between items-start md:items-center\",\n            children: [/*#__PURE__*/_jsxDEV(CardTitle, {\n              children: \"Filter dan Aksi\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 303,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex flex-wrap items-center gap-2 mt-2 md:mt-0\",\n              children: [/*#__PURE__*/_jsxDEV(Button, {\n                onClick: () => handleOpenDialog(null),\n                children: \"Tambah Nilai\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 305,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                variant: \"outline\",\n                onClick: handleDownloadTemplate,\n                children: \"Download Template\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 306,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center gap-2\",\n                children: [/*#__PURE__*/_jsxDEV(Input, {\n                  type: \"file\",\n                  ref: fileInputRef,\n                  accept: \".xlsx\",\n                  className: \"max-w-xs\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 308,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(Button, {\n                  onClick: handleUploadExcel,\n                  disabled: uploading,\n                  children: uploading ? \"Mengunggah...\" : \"Upload Excel\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 309,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 307,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 304,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(CardContent, {\n          className: \"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4 border-t\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-2\",\n            children: [/*#__PURE__*/_jsxDEV(Label, {\n              children: \"Tahun Ajaran\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 318,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Select, {\n              value: filters.tahun_ajaran_id,\n              onValueChange: v => setFilters(prev => ({\n                ...prev,\n                tahun_ajaran_id: v\n              })),\n              children: [/*#__PURE__*/_jsxDEV(SelectTrigger, {\n                children: /*#__PURE__*/_jsxDEV(SelectValue, {\n                  placeholder: \"Semua Tahun Ajaran\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 320,\n                  columnNumber: 36\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 320,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(SelectContent, {\n                children: options.tahunAjaran.map(t => /*#__PURE__*/_jsxDEV(SelectItem, {\n                  value: String(t.id),\n                  children: `${t.nama_ajaran} (Sem ${t.semester})`\n                }, t.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 322,\n                  columnNumber: 55\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 321,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 319,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 317,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-2\",\n            children: [/*#__PURE__*/_jsxDEV(Label, {\n              children: \"Tingkatan\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 327,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Select, {\n              value: filters.tingkatan_id,\n              onValueChange: v => setFilters(prev => ({\n                ...prev,\n                tingkatan_id: v,\n                kelas_id: \"\"\n              })),\n              children: [/*#__PURE__*/_jsxDEV(SelectTrigger, {\n                children: /*#__PURE__*/_jsxDEV(SelectValue, {\n                  placeholder: \"Semua Tingkatan\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 329,\n                  columnNumber: 36\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 329,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(SelectContent, {\n                children: options.tingkatan.map(t => /*#__PURE__*/_jsxDEV(SelectItem, {\n                  value: String(t.id),\n                  children: t.nama_tingkatan\n                }, t.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 331,\n                  columnNumber: 53\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 330,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 328,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 326,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-2\",\n            children: [/*#__PURE__*/_jsxDEV(Label, {\n              children: \"Kelas\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 336,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Select, {\n              value: filters.kelas_id,\n              onValueChange: v => setFilters(prev => ({\n                ...prev,\n                kelas_id: v\n              })),\n              disabled: !filters.tingkatan_id,\n              children: [/*#__PURE__*/_jsxDEV(SelectTrigger, {\n                children: /*#__PURE__*/_jsxDEV(SelectValue, {\n                  placeholder: \"Semua Kelas\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 338,\n                  columnNumber: 36\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 338,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(SelectContent, {\n                children: options.kelas.map(k => /*#__PURE__*/_jsxDEV(SelectItem, {\n                  value: String(k.id),\n                  children: k.nama_kelas\n                }, k.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 340,\n                  columnNumber: 49\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 339,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 337,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 335,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Card, {\n        children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n          children: /*#__PURE__*/_jsxDEV(CardTitle, {\n            children: \"Daftar Nilai Siswa\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 350,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 349,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(CardContent, {\n          children: /*#__PURE__*/_jsxDEV(Table, {\n            children: [/*#__PURE__*/_jsxDEV(TableHeader, {\n              children: /*#__PURE__*/_jsxDEV(TableRow, {\n                children: [/*#__PURE__*/_jsxDEV(TableHead, {\n                  children: \"Siswa\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 356,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n                  children: \"Mata Pelajaran\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 357,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n                  children: \"Nilai\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 358,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n                  children: \"Semester\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 359,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(TableHead, {\n                  className: \"text-right\",\n                  children: \"Aksi\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 360,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 355,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 354,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(TableBody, {\n              children: loading ? /*#__PURE__*/_jsxDEV(TableRow, {\n                children: /*#__PURE__*/_jsxDEV(TableCell, {\n                  colSpan: 5,\n                  className: \"text-center\",\n                  children: \"Memuat data...\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 365,\n                  columnNumber: 29\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 365,\n                columnNumber: 19\n              }, this) : nilaiList.length > 0 ? nilaiList.map(item => {\n                var _options$siswa$find, _options$mapel$find;\n                return /*#__PURE__*/_jsxDEV(TableRow, {\n                  children: [/*#__PURE__*/_jsxDEV(TableCell, {\n                    children: ((_options$siswa$find = options.siswa.find(s => s.id === item.siswa_id)) === null || _options$siswa$find === void 0 ? void 0 : _options$siswa$find.nama) || `ID: ${item.siswa_id}`\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 369,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                    children: ((_options$mapel$find = options.mapel.find(m => m.id === item.mapel_id)) === null || _options$mapel$find === void 0 ? void 0 : _options$mapel$find.nama_mapel) || `ID: ${item.mapel_id}`\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 370,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                    children: item.nilai\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 371,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                    children: item.semester\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 372,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                    className: \"text-right space-x-2\",\n                    children: [/*#__PURE__*/_jsxDEV(Button, {\n                      variant: \"outline\",\n                      size: \"sm\",\n                      onClick: () => handleOpenDialog(item),\n                      children: \"Edit\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 374,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(Button, {\n                      variant: \"destructive\",\n                      size: \"sm\",\n                      onClick: () => handleDelete(item.id),\n                      children: \"Hapus\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 375,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 373,\n                    columnNumber: 23\n                  }, this)]\n                }, item.id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 368,\n                  columnNumber: 21\n                }, this);\n              }) : /*#__PURE__*/_jsxDEV(TableRow, {\n                children: /*#__PURE__*/_jsxDEV(TableCell, {\n                  colSpan: 5,\n                  className: \"text-center\",\n                  children: \"Data tidak ditemukan.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 380,\n                  columnNumber: 29\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 380,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 363,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 353,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 352,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 348,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n        open: isModalOpen,\n        onOpenChange: setIsModalOpen,\n        children: /*#__PURE__*/_jsxDEV(DialogContent, {\n          children: /*#__PURE__*/_jsxDEV(\"form\", {\n            onSubmit: handleSubmit(onSubmit),\n            children: [/*#__PURE__*/_jsxDEV(DialogHeader, {\n              children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n                children: editingNilai !== null && editingNilai !== void 0 && editingNilai.id ? \"Edit Nilai\" : \"Tambah Nilai Baru\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 392,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(DialogDescription, {\n                children: \"Lengkapi semua informasi yang diperlukan.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 393,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 391,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid gap-4 py-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-2\",\n                children: [/*#__PURE__*/_jsxDEV(Label, {\n                  children: \"Siswa *\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 397,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Controller, {\n                  name: \"siswa_id\",\n                  control: control,\n                  rules: {\n                    required: true\n                  },\n                  render: ({\n                    field\n                  }) => /*#__PURE__*/_jsxDEV(Select, {\n                    onValueChange: field.onChange,\n                    value: field.value,\n                    children: [/*#__PURE__*/_jsxDEV(SelectTrigger, {\n                      children: /*#__PURE__*/_jsxDEV(SelectValue, {\n                        placeholder: \"Pilih Siswa\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 400,\n                        columnNumber: 38\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 400,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(SelectContent, {\n                      children: options.siswa.map(s => /*#__PURE__*/_jsxDEV(SelectItem, {\n                        value: String(s.id),\n                        children: s.nis ? `${s.nis} - ${s.nama}` : s.nama\n                      }, s.id, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 402,\n                        columnNumber: 49\n                      }, this))\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 401,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 399,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 398,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 396,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-2\",\n                children: [/*#__PURE__*/_jsxDEV(Label, {\n                  children: \"Mata Pelajaran *\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 408,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Controller, {\n                  name: \"mapel_id\",\n                  control: control,\n                  rules: {\n                    required: true\n                  },\n                  render: ({\n                    field\n                  }) => /*#__PURE__*/_jsxDEV(Select, {\n                    onValueChange: field.onChange,\n                    value: field.value,\n                    children: [/*#__PURE__*/_jsxDEV(SelectTrigger, {\n                      children: /*#__PURE__*/_jsxDEV(SelectValue, {\n                        placeholder: \"Pilih Mata Pelajaran\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 411,\n                        columnNumber: 38\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 411,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(SelectContent, {\n                      children: options.mapel.map(m => /*#__PURE__*/_jsxDEV(SelectItem, {\n                        value: String(m.id),\n                        children: m.nama_mapel\n                      }, m.id, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 413,\n                        columnNumber: 49\n                      }, this))\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 412,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 410,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 409,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 407,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-2\",\n                children: [/*#__PURE__*/_jsxDEV(Label, {\n                  children: \"Tahun Ajaran & Semester *\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 419,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Controller, {\n                  name: \"tahun_ajaran_id\",\n                  control: control,\n                  rules: {\n                    required: true\n                  },\n                  render: ({\n                    field\n                  }) => /*#__PURE__*/_jsxDEV(Select, {\n                    onValueChange: value => {\n                      field.onChange(value);\n                      const ta = options.tahunAjaran.find(t => t.id === Number(value));\n                      if (ta) setValue('semester', ta.semester);\n                    },\n                    value: field.value,\n                    children: [/*#__PURE__*/_jsxDEV(SelectTrigger, {\n                      children: /*#__PURE__*/_jsxDEV(SelectValue, {\n                        placeholder: \"Pilih Tahun Ajaran\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 426,\n                        columnNumber: 39\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 426,\n                      columnNumber: 24\n                    }, this), /*#__PURE__*/_jsxDEV(SelectContent, {\n                      children: options.tahunAjaran.map(t => /*#__PURE__*/_jsxDEV(SelectItem, {\n                        value: String(t.id),\n                        children: `${t.nama_ajaran} (Sem ${t.semester})`\n                      }, t.id, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 428,\n                        columnNumber: 56\n                      }, this))\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 427,\n                      columnNumber: 24\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 421,\n                    columnNumber: 22\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 420,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 418,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"space-y-2\",\n                children: [/*#__PURE__*/_jsxDEV(Label, {\n                  children: \"Nilai *\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 434,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(Input, {\n                  type: \"number\",\n                  ...register('nilai', {\n                    required: true\n                  }),\n                  step: \"0.01\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 435,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 433,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 395,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(DialogFooter, {\n              children: [/*#__PURE__*/_jsxDEV(Button, {\n                type: \"button\",\n                variant: \"outline\",\n                onClick: () => setIsModalOpen(false),\n                children: \"Batal\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 439,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                type: \"submit\",\n                children: \"Simpan\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 440,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 438,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 390,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 389,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 388,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 295,\n    columnNumber: 5\n  }, this);\n}\n_s(InputNilaiPage, \"mZTVrAzE3CrMROb5UkJ+e5bUWcA=\", false, function () {\n  return [useToast, useForm];\n});\n_c = InputNilaiPage;\nvar _c;\n$RefreshReg$(_c, \"InputNilaiPage\");","map":{"version":3,"names":["_jsxFileName","_s","$RefreshSig$","useState","useEffect","useCallback","useRef","Button","DashboardLayout","Dialog","DialogContent","DialogDescription","DialogFooter","DialogHeader","DialogTitle","Input","Label","Select","SelectContent","SelectItem","SelectTrigger","SelectValue","Table","TableBody","TableCell","TableHead","TableHeader","TableRow","useToast","Card","CardContent","CardHeader","CardTitle","useForm","Controller","nilaiService","siswaService","mapelService","kelasService","tahunAjaranService","excelService","tingkatanService","jsxDEV","_jsxDEV","InputNilaiPage","nilaiList","setNilaiList","options","setOptions","siswa","mapel","kelas","tahunAjaran","tingkatan","filters","setFilters","kelas_id","tahun_ajaran_id","tingkatan_id","loading","setLoading","isModalOpen","setIsModalOpen","editingNilai","setEditingNilai","fileInputRef","uploading","setUploading","toast","control","handleSubmit","reset","setValue","register","defaultValues","siswa_id","mapel_id","nilai","semester","fetchNilaiData","activeFilters","Object","fromEntries","entries","filter","_","value","nilaiData","getAllNilai","error","console","title","description","variant","mounted","loadOptions","siswaData","mapelData","tahunData","tingkatanData","Promise","all","getAllSiswa","show_all","getAllMapel","getAllTahunAjaran","getAllTingkatans","prev","timeoutId","setTimeout","clearTimeout","getKelasByTingkatan","then","kelasData","catch","err","f","handleOpenDialog","ta","find","t","id","String","onSubmit","formData","payload","Number","updateNilai","createNilai","_error$response","_error$response$data","response","data","message","handleDelete","window","confirm","deleteNilai","_error$response2","_error$response2$data","handleDownloadTemplate","blobData","downloadCompleteTemplate","blob","Blob","type","url","URL","createObjectURL","a","document","createElement","href","download","click","revokeObjectURL","e","_e$response","_e$response$data","handleUploadExcel","_fileInputRef$current","_fileInputRef$current2","file","current","files","fd","FormData","append","json","uploadCompleteData","_e$response2","_e$response2$data","children","className","fileName","lineNumber","columnNumber","onClick","ref","accept","disabled","onValueChange","v","placeholder","map","nama_ajaran","nama_tingkatan","k","nama_kelas","colSpan","length","item","_options$siswa$find","_options$mapel$find","s","nama","m","nama_mapel","size","open","onOpenChange","name","rules","required","render","field","onChange","nis","step","_c","$RefreshReg$"],"sources":["C:/laragon/www/E-RAPORT-NUURUSH-SHOLAAH/e-raport-client/src/dashboard/input-nilai/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect, useCallback, useRef } from \"react\";\r\nimport { Button } from \"../../components/ui/button\";\r\nimport DashboardLayout from '../../dashboard/layout';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from \"../../components/ui/dialog\";\r\nimport { Input } from \"../../components/ui/input\";\r\nimport { Label } from \"../../components/ui/label\";\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from \"../../components/ui/select\";\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from \"../../components/ui/table\";\r\nimport { useToast } from \"../../components/ui/toast\";\r\nimport { Card, CardContent, CardHeader, CardTitle } from \"../../components/ui/card\";\r\nimport { useForm, Controller } from 'react-hook-form';\r\n\r\nimport nilaiService from '../../services/nilaiService'\r\nimport siswaService from '../../services/siswaService'\r\nimport mapelService from '../../services/mapelService'\r\nimport kelasService from '../../services/kelasService'\r\nimport tahunAjaranService from '../../services/tahunAjaranService'\r\nimport excelService from '../../services/excelService'\r\nimport * as tingkatanService from '../../services/tingkatanService'\r\n\r\n// --- TIPE DATA ---\r\ninterface Tingkatan { id: number; nama_tingkatan: string; }\r\ninterface Siswa { id: number; nis?: string; nama: string; kelas_id?: number; }\r\ninterface Mapel { id: number; nama_mapel: string; }\r\ninterface Kelas { id: number; nama_kelas: string; }\r\ninterface TahunAjaran { id: number; nama_ajaran: string; semester: string; }\r\ninterface Nilai {\r\n  id: number;\r\n  siswa_id: number;\r\n  mapel_id: number;\r\n  nilai: number;\r\n  semester: string;\r\n  tahun_ajaran_id: number;\r\n  siswa?: { nama: string; nis?: string };\r\n  mapel?: Mapel;\r\n}\r\ntype FormData = {\r\n  id?: number;\r\n  siswa_id: string;\r\n  mapel_id: string;\r\n  nilai: string;\r\n  semester: string;\r\n  tahun_ajaran_id: string;\r\n}\r\n\r\nexport default function InputNilaiPage() {\r\n  const [nilaiList, setNilaiList] = useState<Nilai[]>([]);\r\n  const [options, setOptions] = useState<{\r\n    siswa: Siswa[];\r\n    mapel: Mapel[];\r\n    kelas: Kelas[];\r\n    tahunAjaran: TahunAjaran[];\r\n    tingkatan: Tingkatan[];\r\n  }>({ siswa: [], mapel: [], kelas: [], tahunAjaran: [], tingkatan: [] });\r\n  \r\n  const [filters, setFilters] = useState({ \r\n    kelas_id: \"\", \r\n    tahun_ajaran_id: \"\", \r\n    tingkatan_id: \"\" \r\n  });\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n  const [editingNilai, setEditingNilai] = useState<Partial<Nilai> | null>(null);\r\n  const fileInputRef = useRef<HTMLInputElement | null>(null);\r\n  const [uploading, setUploading] = useState(false);\r\n  const { toast } = useToast();\r\n  \r\n  const { control, handleSubmit, reset, setValue, register } = useForm<FormData>({\r\n    defaultValues: {\r\n      siswa_id: \"\",\r\n      mapel_id: \"\",\r\n      nilai: \"\",\r\n      semester: \"\",\r\n      tahun_ajaran_id: \"\",\r\n    }\r\n  });\r\n\r\n  const fetchNilaiData = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const activeFilters = Object.fromEntries(\r\n        Object.entries(filters).filter(([_, value]) => value !== \"\")\r\n      );\r\n      const nilaiData = await nilaiService.getAllNilai(activeFilters);\r\n      setNilaiList(nilaiData);\r\n    } catch (error) {\r\n      console.error(\"Gagal memuat data nilai:\", error);\r\n      toast({ title: \"Gagal Memuat Nilai\", description: \"Tidak dapat mengambil data nilai dari server.\", variant: \"destructive\" });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [filters, toast]);\r\n\r\n  // FIXED: Load options once on mount\r\n  useEffect(() => {\r\n    let mounted = true\r\n    const loadOptions = async () => {\r\n      try {\r\n        const [siswaData, mapelData, tahunData, tingkatanData] = await Promise.all([\r\n          siswaService.getAllSiswa({ show_all: true }),\r\n          mapelService.getAllMapel(),\r\n          tahunAjaranService.getAllTahunAjaran(),\r\n          tingkatanService.getAllTingkatans(),\r\n        ]);\r\n        if (mounted) {\r\n          setOptions(prev => ({ \r\n            ...prev, \r\n            siswa: siswaData, \r\n            mapel: mapelData, \r\n            tahunAjaran: tahunData, \r\n            tingkatan: tingkatanData \r\n          }));\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Gagal memuat opsi dropdown:\", error);\r\n      }\r\n    };\r\n    loadOptions();\r\n    \r\n    return () => { mounted = false }\r\n  }, []);\r\n\r\n  // FIXED: Debounced fetch when filters change\r\n  useEffect(() => {\r\n    let timeoutId: NodeJS.Timeout\r\n    timeoutId = setTimeout(() => {\r\n      fetchNilaiData();\r\n    }, 300)\r\n    \r\n    return () => clearTimeout(timeoutId)\r\n  }, [filters]);\r\n\r\n  // FIXED: Stable kelas fetching\r\n  useEffect(() => {\r\n    let mounted = true\r\n    if (filters.tingkatan_id) {\r\n      kelasService.getKelasByTingkatan(filters.tingkatan_id)\r\n        .then(kelasData => {\r\n          if (mounted) {\r\n            setOptions(prev => ({ ...prev, kelas: kelasData }))\r\n          }\r\n        })\r\n        .catch(err => console.error('Error fetching kelas:', err));\r\n    } else {\r\n      if (mounted) {\r\n        setOptions(prev => ({ ...prev, kelas: [] }));\r\n        setFilters(f => ({ ...f, kelas_id: \"\" }));\r\n      }\r\n    }\r\n    \r\n    return () => { mounted = false }\r\n  }, [filters.tingkatan_id]);\r\n\r\n  const handleOpenDialog = (nilai: Partial<Nilai> | null) => {\r\n    setEditingNilai(nilai);\r\n    if (nilai) {\r\n      const ta = options.tahunAjaran.find(t => t.id === nilai.tahun_ajaran_id);\r\n      reset({\r\n        id: nilai.id,\r\n        siswa_id: String(nilai.siswa_id || \"\"),\r\n        mapel_id: String(nilai.mapel_id || \"\"),\r\n        nilai: String(nilai.nilai || \"\"),\r\n        semester: nilai.semester || ta?.semester || \"\",\r\n        tahun_ajaran_id: String(nilai.tahun_ajaran_id || \"\"),\r\n      });\r\n    } else {\r\n      reset({ siswa_id: '', mapel_id: '', nilai: '', semester: '', tahun_ajaran_id: '' });\r\n    }\r\n    setIsModalOpen(true);\r\n  };\r\n\r\n  const onSubmit = async (formData: FormData) => {\r\n    try {\r\n      const payload = {\r\n        ...formData,\r\n        siswa_id: Number(formData.siswa_id),\r\n        mapel_id: Number(formData.mapel_id),\r\n        tahun_ajaran_id: Number(formData.tahun_ajaran_id),\r\n        nilai: Number(formData.nilai),\r\n      };\r\n\r\n      if (editingNilai?.id) {\r\n        await nilaiService.updateNilai(editingNilai.id, payload);\r\n        toast({ title: \"Berhasil\", description: \"Data nilai diperbarui\" });\r\n      } else {\r\n        await nilaiService.createNilai(payload);\r\n        toast({ title: \"Berhasil\", description: \"Data nilai ditambahkan\" });\r\n      }\r\n      setIsModalOpen(false);\r\n      fetchNilaiData();\r\n    } catch (error: any) {\r\n      toast({ title: \"Gagal\", description: error.response?.data?.message || \"Gagal menyimpan data.\", variant: \"destructive\" });\r\n    }\r\n  };\r\n  \r\n  const handleDelete = async (id: number) => {\r\n    if (window.confirm(\"Apakah Anda yakin ingin menghapus data nilai ini?\")) {\r\n      try {\r\n        await nilaiService.deleteNilai(id);\r\n        toast({ title: \"Berhasil\", description: \"Data nilai dihapus\" });\r\n        fetchNilaiData();\r\n      } catch (error: any) {\r\n        toast({\r\n          title: \"Gagal\",\r\n          description: error.response?.data?.message || \"Gagal menghapus data.\",\r\n          variant: \"destructive\",\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleDownloadTemplate = async () => {\r\n    if (!filters.tahun_ajaran_id || !filters.tingkatan_id || !filters.kelas_id) {\r\n      toast({\r\n        title: \"Filter Tidak Lengkap\",\r\n        description: \"Harap pilih Tahun Ajaran, Tingkatan, dan Kelas terlebih dahulu.\",\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n    try {\r\n      const blobData = await excelService.downloadCompleteTemplate({ \r\n        kelas_id: filters.kelas_id, \r\n        tahun_ajaran_id: filters.tahun_ajaran_id,\r\n        tingkatan_id: filters.tingkatan_id\r\n      });\r\n      const blob = new Blob([blobData], { type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\" });\r\n      const url = window.URL.createObjectURL(blob);\r\n      const a = document.createElement(\"a\");\r\n      a.href = url;\r\n      a.download = `template-nilai-lengkap.xlsx`;\r\n      a.click();\r\n      window.URL.revokeObjectURL(url);\r\n      toast({ title: \"Template berhasil diunduh\" });\r\n    } catch (e: any) {\r\n      toast({\r\n        title: \"Gagal Unduh\",\r\n        description: e?.response?.data?.message || \"Terjadi kesalahan saat membuat template.\",\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  };\r\n  \r\n  const handleUploadExcel = async () => {\r\n    const file = fileInputRef.current?.files?.[0];\r\n    if (!file) {\r\n      toast({ title: \"Pilih File\", description: \"Silakan pilih file Excel untuk diunggah.\", variant: \"destructive\" });\r\n      return;\r\n    }\r\n    \r\n    setUploading(true);\r\n    const fd = new FormData();\r\n    fd.append(\"file\", file);\r\n\r\n    try {\r\n      const json = await excelService.uploadCompleteData(fd);\r\n      toast({ title: \"Upload Selesai\", description: json?.message || \"File berhasil diproses.\" });\r\n      fetchNilaiData();\r\n    } catch (e: any) {\r\n      toast({\r\n        title: \"Gagal Upload\",\r\n        description: e?.response?.data?.message || \"Terjadi kesalahan saat mengunggah file.\",\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setUploading(false);\r\n      if (fileInputRef.current) fileInputRef.current.value = \"\";\r\n    }\r\n  };\r\n\r\n  return (\r\n    <DashboardLayout>\r\n      <div className=\"space-y-6\">\r\n        <h1 className=\"text-3xl font-bold\">Manajemen Input Nilai</h1>\r\n\r\n        {/* PERBAIKAN LAYOUT: KARTU UNTUK FILTER DAN AKSI */}\r\n        <Card>\r\n          <CardHeader>\r\n            <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center\">\r\n              <CardTitle>Filter dan Aksi</CardTitle>\r\n              <div className=\"flex flex-wrap items-center gap-2 mt-2 md:mt-0\">\r\n                <Button onClick={() => handleOpenDialog(null)}>Tambah Nilai</Button>\r\n                <Button variant=\"outline\" onClick={handleDownloadTemplate}>Download Template</Button>\r\n                <div className=\"flex items-center gap-2\">\r\n                    <Input type=\"file\" ref={fileInputRef} accept=\".xlsx\" className=\"max-w-xs\"/>\r\n                    <Button onClick={handleUploadExcel} disabled={uploading}>\r\n                      {uploading ? \"Mengunggah...\" : \"Upload Excel\"}\r\n                    </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent className=\"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4 border-t\">\r\n            <div className=\"space-y-2\">\r\n                <Label>Tahun Ajaran</Label>\r\n                <Select value={filters.tahun_ajaran_id} onValueChange={(v) => setFilters(prev => ({...prev, tahun_ajaran_id: v}))}>\r\n                    <SelectTrigger><SelectValue placeholder=\"Semua Tahun Ajaran\" /></SelectTrigger>\r\n                    <SelectContent>\r\n                        {options.tahunAjaran.map(t => <SelectItem key={t.id} value={String(t.id)}>{`${t.nama_ajaran} (Sem ${t.semester})`}</SelectItem>)}\r\n                    </SelectContent>\r\n                </Select>\r\n            </div>\r\n            <div className=\"space-y-2\">\r\n                <Label>Tingkatan</Label>\r\n                <Select value={filters.tingkatan_id} onValueChange={(v) => setFilters(prev => ({...prev, tingkatan_id: v, kelas_id: \"\"}))}>\r\n                    <SelectTrigger><SelectValue placeholder=\"Semua Tingkatan\" /></SelectTrigger>\r\n                    <SelectContent>\r\n                        {options.tingkatan.map(t => <SelectItem key={t.id} value={String(t.id)}>{t.nama_tingkatan}</SelectItem>)}\r\n                    </SelectContent>\r\n                </Select>\r\n            </div>\r\n            <div className=\"space-y-2\">\r\n                <Label>Kelas</Label>\r\n                <Select value={filters.kelas_id} onValueChange={(v) => setFilters(prev => ({...prev, kelas_id: v}))} disabled={!filters.tingkatan_id}>\r\n                    <SelectTrigger><SelectValue placeholder=\"Semua Kelas\" /></SelectTrigger>\r\n                    <SelectContent>\r\n                        {options.kelas.map(k => <SelectItem key={k.id} value={String(k.id)}>{k.nama_kelas}</SelectItem>)}\r\n                    </SelectContent>\r\n                </Select>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* PERBAIKAN LAYOUT: KARTU TERPISAH UNTUK TABEL DATA */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Daftar Nilai Siswa</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <Table>\r\n              <TableHeader>\r\n                <TableRow>\r\n                  <TableHead>Siswa</TableHead>\r\n                  <TableHead>Mata Pelajaran</TableHead>\r\n                  <TableHead>Nilai</TableHead>\r\n                  <TableHead>Semester</TableHead>\r\n                  <TableHead className=\"text-right\">Aksi</TableHead>\r\n                </TableRow>\r\n              </TableHeader>\r\n              <TableBody>\r\n                {loading ? (\r\n                  <TableRow><TableCell colSpan={5} className=\"text-center\">Memuat data...</TableCell></TableRow>\r\n                ) : nilaiList.length > 0 ? (\r\n                  nilaiList.map((item) => (\r\n                    <TableRow key={item.id}>\r\n                      <TableCell>{options.siswa.find(s => s.id === item.siswa_id)?.nama || `ID: ${item.siswa_id}`}</TableCell>\r\n                      <TableCell>{options.mapel.find(m => m.id === item.mapel_id)?.nama_mapel || `ID: ${item.mapel_id}`}</TableCell>\r\n                      <TableCell>{item.nilai}</TableCell>\r\n                      <TableCell>{item.semester}</TableCell>\r\n                      <TableCell className=\"text-right space-x-2\">\r\n                        <Button variant=\"outline\" size=\"sm\" onClick={() => handleOpenDialog(item)}>Edit</Button>\r\n                        <Button variant=\"destructive\" size=\"sm\" onClick={() => handleDelete(item.id)}>Hapus</Button>\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  ))\r\n                ) : (\r\n                  <TableRow><TableCell colSpan={5} className=\"text-center\">Data tidak ditemukan.</TableCell></TableRow>\r\n                )}\r\n              </TableBody>\r\n            </Table>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Dialog untuk Tambah/Edit Nilai (Tidak ada perubahan layout, hanya fungsionalitas) */}\r\n        <Dialog open={isModalOpen} onOpenChange={setIsModalOpen}>\r\n          <DialogContent>\r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n              <DialogHeader>\r\n                <DialogTitle>{editingNilai?.id ? \"Edit Nilai\" : \"Tambah Nilai Baru\"}</DialogTitle>\r\n                <DialogDescription>Lengkapi semua informasi yang diperlukan.</DialogDescription>\r\n              </DialogHeader>\r\n              <div className=\"grid gap-4 py-4\">\r\n                <div className=\"space-y-2\">\r\n                  <Label>Siswa *</Label>\r\n                  <Controller name=\"siswa_id\" control={control} rules={{ required: true }} render={({ field }) => (\r\n                    <Select onValueChange={field.onChange} value={field.value}>\r\n                      <SelectTrigger><SelectValue placeholder=\"Pilih Siswa\" /></SelectTrigger>\r\n                      <SelectContent>\r\n                        {options.siswa.map(s => <SelectItem key={s.id} value={String(s.id)}>{s.nis ? `${s.nis} - ${s.nama}` : s.nama}</SelectItem>)}\r\n                      </SelectContent>\r\n                    </Select>\r\n                  )} />\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  <Label>Mata Pelajaran *</Label>\r\n                  <Controller name=\"mapel_id\" control={control} rules={{ required: true }} render={({ field }) => (\r\n                    <Select onValueChange={field.onChange} value={field.value}>\r\n                      <SelectTrigger><SelectValue placeholder=\"Pilih Mata Pelajaran\" /></SelectTrigger>\r\n                      <SelectContent>\r\n                        {options.mapel.map(m => <SelectItem key={m.id} value={String(m.id)}>{m.nama_mapel}</SelectItem>)}\r\n                      </SelectContent>\r\n                    </Select>\r\n                  )} />\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  <Label>Tahun Ajaran & Semester *</Label>\r\n                  <Controller name=\"tahun_ajaran_id\" control={control} rules={{ required: true }} render={({ field }) => (\r\n                     <Select onValueChange={(value) => {\r\n                         field.onChange(value);\r\n                         const ta = options.tahunAjaran.find(t => t.id === Number(value));\r\n                         if (ta) setValue('semester', ta.semester);\r\n                     }} value={field.value}>\r\n                       <SelectTrigger><SelectValue placeholder=\"Pilih Tahun Ajaran\" /></SelectTrigger>\r\n                       <SelectContent>\r\n                         {options.tahunAjaran.map(t => <SelectItem key={t.id} value={String(t.id)}>{`${t.nama_ajaran} (Sem ${t.semester})`}</SelectItem>)}\r\n                       </SelectContent>\r\n                     </Select>\r\n                  )} />\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  <Label>Nilai *</Label>\r\n                  <Input type=\"number\" {...register('nilai', { required: true })} step=\"0.01\" />\r\n                </div>\r\n              </div>\r\n              <DialogFooter>\r\n                <Button type=\"button\" variant=\"outline\" onClick={() => setIsModalOpen(false)}>Batal</Button>\r\n                <Button type=\"submit\">Simpan</Button>\r\n              </DialogFooter>\r\n            </form>\r\n          </DialogContent>\r\n        </Dialog>\r\n      </div>\r\n    </DashboardLayout>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}